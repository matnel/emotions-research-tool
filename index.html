<html>
<head>
</head>
<script type='text/javascript' src='./lib/jquery.js' ></script>
<script type='text/javascript' src='./lib/jquery-ui.js' ></script>
<link type='text/css' rel='stylesheet' href='./lib/jquery-theme/smoothness/jquery-ui-1.8.7.custom.css' /> 
<body>

<span id='map-container' style='position:fixed; top: 0px; left: 0px;'>
<img id='map' src='./moods.png' ></img>
</span>

<script type='text/javascript'>

$(document).ready( function() {

$('#map').click( function(event) {
	console.log( event );
	var x = event.pageX;
	var y = event.pageY;
	var height = $('#map').height();
	var width = $('#map').width();
	// calculate real x, y based on maps position
	x = x - $('#map').position().left;
	var x0 = x - width / 2;
	y = y - $('#map').position().top;
	var y0 = (height / 2) - y;
	var div = $('<div>');
	div.append( 'X:' + x0 + ' Y: ' + y0 + '<br/>' );
	div.append( 'Organisaation nimi' );
	var name = $('<input>', { id: 'name' });
	div.append( name );
	div.append( 'Miksi?<br/>' );
	div.append( $('<textarea>') );

	div.dialog( {
		buttons : {
			'Valmis' : function(){
				$(this).dialog('close');
				$(this).remove();
				var point = $('<div>' , { style: 'position: absolute; z-index: 10; height: 10px; width: 10px;' });
				console.log( name.val() );
				point.html( name.val() + ' (' + x0 + ',' + y0 + ') (' + x + ',' + y + ')' );
				point.css( { 'top' : y, 'left' : x } );
				$('#map-container').append( point );
			},
			'Peru'   : function(){ $(this).dialog('close'); $(this).remove(); }
		}
	} );
} );

} );
</script>

</body>
</html>
